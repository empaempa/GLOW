// GLOW.js r1.1 - http://github.com/empaempa/GLOW
var GLOW=function(){var b={},a={},c=-1;b.currentContext={};b.registerContext=function(c){a[c.id]=c;b.enableContext(c)};b.getContextById=function(c){if(a[c])return a[c];console.error("Couldn't find context id "+c+", returning current with id "+b.currentContext.id);return b.currentContext};b.enableContext=function(a){b.currentContext=typeof a==="string"?getContextById(a):a;GL=b.GL=b.currentContext.GL};b.uniqueId=function(){return++c};return b}(),GL={};
GLOW.Context=function(){function b(a){a===void 0&&(a={});this.id=a.id!==void 0?a.id:GLOW.uniqueId();this.alpha=a.alpha!==void 0?a.alpha:!0;this.depth=a.depth!==void 0?a.depth:!0;this.antialias=a.antialias!==void 0?a.antialias:!0;this.stencil=a.stencil!==void 0?a.stencil:!1;this.premultipliedAlpha=a.premultipliedAlpha!==void 0?a.premultipliedAlpha:!0;this.preserveDrawingBuffer=a.preserveDrawingBuffer!==void 0?a.preserveDrawingBuffer:!1;this.width=a.width!==void 0?a.width:window.innerWidth;this.height=
a.height!==void 0?a.height:window.innerHeight;this.cache=new GLOW.Cache;if(a.context)this.GL=a.context,GLOW.registerContext(this);else{try{this.domElement=document.createElement("canvas"),this.GL=this.domElement.getContext("experimental-webgl",{alpha:this.alpha,depth:this.depth,antialias:this.antialias,stencil:this.stencil,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer})}catch(c){console.error("GLOW.Context.construct: "+c)}if(this.GL!==null){GLOW.registerContext(this);
this.domElement.width=this.width;this.domElement.height=this.height;this.viewport=a.viewport?{x:a.viewport.x!==void 0?a.viewport.x:0,y:a.viewport.y!==void 0?a.viewport.y:0,width:a.viewport.width!==void 0?a.viewport.width:this.width,height:a.viewport.height!==void 0?a.viewport.height:this.height}:{x:0,y:0,width:this.width,height:this.height};if(a.clear){if(this.clearSettings={r:a.clear.red!==void 0?a.clear.red:0,g:a.clear.green!==void 0?a.clear.green:0,b:a.clear.blue!==void 0?a.clear.blue:0,a:a.clear.alpha!==
void 0?a.clear.alpha:1,depth:a.clear.depth!==void 0?a.clear.depth:1,bits:a.clear.bits!==void 0?a.clear.bits:-1},this.clearSettings.bits===-1)this.clearSettings.bits=GL.COLOR_BUFFER_BIT,this.clearSettings.bits|=this.depth?GL.DEPTH_BUFFER_BIT:0,this.clearSettings.bits|=this.stencil?GL.STENCIL_BUFFER_BIT:0}else this.clearSettings={r:0,g:0,b:0,a:1,depth:1,bits:0},this.clearSettings.bits=GL.COLOR_BUFFER_BIT,this.clearSettings.bits|=this.depth?GL.DEPTH_BUFFER_BIT:0,this.clearSettings.bits|=this.stencil?
GL.STENCIL_BUFFER_BIT:0;this.enableCulling(!0,{frontFace:GL.CCW,cullFace:GL.BACK});this.enableDepthTest(!0,{func:GL.LEQUAL,write:!0,zNear:0,zFar:1});this.enableBlend(!1);this.setViewport();this.clear()}else console.error("GLOW.Context.construct: unable to initialize WebGL")}}b.prototype.setupClear=function(a){if(a!==void 0)this.clearSettings.r=a.red!==void 0?Math.min(1,Math.max(0,a.red)):this.clearSettings.r,this.clearSettings.g=a.green!==void 0?Math.min(1,Math.max(0,a.green)):this.clearSettings.g,
this.clearSettings.b=a.blue!==void 0?Math.min(1,Math.max(0,a.blue)):this.clearSettings.b,this.clearSettings.a=a.alpha!==void 0?Math.min(1,Math.max(0,a.alpha)):this.clearSettings.a,this.clearSettings.depth=a.depth!==void 0?Math.min(1,Math.max(0,a.depth)):this.clearSettings.depth,this.clearSettings.bits=a.bits!==void 0?a.bits:this.clearSettings.bits;GL.clearColor(this.clearSettings.r,this.clearSettings.g,this.clearSettings.b,this.clearSettings.a);GL.clearDepth(this.clearSettings.depth);return this};
b.prototype.clear=function(a){this.setupClear(a);GL.clear(this.clearSettings.bits);return this};b.prototype.enableBlend=function(a,c){a?(GL.enable(GL.BLEND),c&&this.setupBlend(c)):GL.disable(GL.BLEND);return this};b.prototype.setupBlend=function(a){a.equationRGB?(a.equationAlpha&&GL.blendEquationSeparate(a.equationRGB,a.equationAlpha),a.srcRGB&&GL.blendFuncSeparate(a.srcRGB,a.dstRGB,a.srcAlpha,a.dstAlpha)):(a.equation&&GL.blendEquation(a.equation),a.src&&GL.blendFunc(a.src,a.dst));return this};b.prototype.enableDepthTest=
function(a,c){a?(GL.enable(GL.DEPTH_TEST),c&&this.setupDepthTest(c)):GL.disable(GL.DEPTH_TEST);return this};b.prototype.setupDepthTest=function(a){a.func!==void 0&&GL.depthFunc(a.func);a.write!==void 0&&GL.depthMask(a.write);a.zNear!==void 0&&a.zFar!==void 0&&a.zNear<=a.zFar&&GL.depthRange(Math.max(0,Math.min(1,a.zNear)),Math.max(0,Math.min(1,a.zFar)));return this};b.prototype.enablePolygonOffset=function(a,c){a?(GL.enable(GL.POLYGON_OFFSET_FILL),c&&this.setupPolygonOffset(c)):GL.disable(GL.POLYGON_OFFSET_FILL);
return this};b.prototype.setupPolygonOffset=function(a){a.factor&&a.units&&GL.polygonOffset(a.factor,a.units)};b.prototype.enableStencilTest=function(a,c){a?(GL.enable(GL.STENCIL_TEST),c&&this.setupStencilTest(c)):GL.disable(GL.STENCIL_TEST);return this};b.prototype.setupStencilTest=function(a){a.func&&a.funcFace?GL.stencilFuncSeparate(a.funcFace,a.func,a.funcRef,a.funcMask):a.func&&GL.stencilFunc(a.func,a.funcRef,a.funcMask);a.mask&&a.maskFace?GL.stencilMaskSeparate(a.maskFace,a.mask):a.mask&&GL.stencilMask(a.mask);
a.opFail&&a.opFace?GL.stencilOpSeparate(a.opFace,a.opFail,a.opZfail,a.opZpass):a.opFail&&GL.stencilOp(a.opFail,a.opZfail,a.opZpass);return this};b.prototype.enableCulling=function(a,c){a?(GL.enable(GL.CULL_FACE),c&&this.setupCulling(c)):GL.disable(GL.CULL_FACE);return this};b.prototype.setupCulling=function(a){try{a.frontFace&&GL.frontFace(a.frontFace),a.cullFace&&GL.cullFace(a.cullFace)}catch(c){console.error("GLOW.Context.setupCulling: "+c)}return this};b.prototype.enableScissor=function(a,c){a?
(GL.enable(GL.SCISSOR_TEST),c&&this.setupScissor(c)):GL.disable(GL.SCISSOR_TEST);return this};b.prototype.setupScissor=function(a){try{GL.scissor(a.x,a.y,a.width,a.height)}catch(c){console.error("GLOW.Context.setupScissorTest: "+c)}return this};b.prototype.setViewport=function(){this.setupViewport()};b.prototype.setupViewport=function(a){if(a)this.viewport.x=a.x!==void 0?a.x:this.viewport.x,this.viewport.y=a.y!==void 0?a.y:this.viewport.y,this.viewport.width=a.width!==void 0?a.width:this.viewport.width,
this.viewport.height=a.height!==void 0?a.height:this.viewport.height;GL.viewport(this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height);return this};b.prototype.availableExtensions=function(){return GL.getSupportedExtensions()};b.prototype.enableExtension=function(a){for(var c=GL.getSupportedExtensions(),b=0,e=c.length;b<e;b++)if(a.toLowerCase()===c[b].toLowerCase())break;if(b!==e)return GL.getExtension(c[b])};b.prototype.getParameter=function(a){return GL.getParameter(a)};b.prototype.maxVertexTextureImageUnits=
function(){return this.getParameter(GL.MAX_VERTEX_TEXTURE_IMAGE_UNITS)};return b}();
GLOW.Compiler=function(){var b={};b.compile=function(a){var c=GLOW.currentContext.cache.codeCompiled(a.vertexShader,a.fragmentShader);c===void 0&&(c=b.linkProgram(b.compileVertexShader(a.vertexShader),b.compileFragmentShader(a.fragmentShader)),GLOW.currentContext.cache.addCompiledProgram(c));var g=b.createUniforms(b.extractUniforms(c),a.data),e=b.createAttributes(b.extractAttributes(c),a.data,a.usage,a.interleave),f=b.interleaveAttributes(e,a.interleave);if(a.elements)console.error("GLOW.Compiler.compile: .elements is no longer supported, please use .indices combined with .primitives");
else{var i=a.indices,h=a.primitives!==void 0?a.primitives:GL.TRIANGLES,j=a.usage!==void 0?a.usage:{},k=j.primitives;if(a.triangles)i=a.triangles,k=j.triangles;else if(a.triangleStrip)i=a.triangleStrip,h=GL.TRIANGLE_STRIP,k=j.triangleStrip;else if(a.triangleFan)i=a.triangleFan,h=GL.TRIANGLE_FAN,k=j.triangleFan;else if(a.points)i=a.points,h=GL.POINTS,k=j.points;else if(a.lines)i=a.lines,h=GL.LINES,k=j.lines;else if(a.lineLoop)i=a.lineLoop,h=GL.LINE_LOOP,k=j.lineLoop;else if(a.lineStrip)i=a.lineStrip,
h=GL.LINE_STRIP,k=j.lineStrip;if(i===void 0){for(var l in e){i=e[l].data.length/e[l].size;break}if(i===void 0)for(var n in f){for(l in f[n].attributes){i=f[n].attributes[l].data.length/f[n].attributes[l].size;break}break}}i=b.createElements(i,h,k);return new GLOW.CompiledData(c,g,e,f,i,a)}};b.compileVertexShader=function(a){var c;c=GL.createShader(GL.VERTEX_SHADER);c.id=GLOW.uniqueId();GL.shaderSource(c,a);GL.compileShader(c);GL.getShaderParameter(c,GL.COMPILE_STATUS)||console.error("GLOW.Compiler.compileVertexShader: "+
GL.getShaderInfoLog(c));return c};b.compileFragmentShader=function(a){var c;c=GL.createShader(GL.FRAGMENT_SHADER);c.id=GLOW.uniqueId();GL.shaderSource(c,a);GL.compileShader(c);GL.getShaderParameter(c,GL.COMPILE_STATUS)||console.error("GLOW.Compiler.compileFragmentShader: "+GL.getShaderInfoLog(c));return c};b.linkProgram=function(a,c){var b;b=GL.createProgram();b.id=GLOW.uniqueId();GL.attachShader(b,a);GL.attachShader(b,c);GL.linkProgram(b);GL.getProgramParameter(b,GL.LINK_STATUS)||console.error("GLOW.Compiler.linkProgram: Could not initialise program");
return b};b.extractUniforms=function(a){for(var c={},b,e=0,f=GL.getProgramParameter(a,GL.ACTIVE_UNIFORMS);e<f;e++)if(b=GL.getActiveUniform(a,e),b!==null&&b!==-1&&b!==void 0)b={name:b.name.split("[")[0],size:b.size,type:b.type,location:GL.getUniformLocation(a,b.name.split("[")[0]),locationNumber:e},c[b.name]=b;else break;return c};b.extractAttributes=function(a){for(var c={},b,e=0,f=GL.getProgramParameter(a,GL.ACTIVE_ATTRIBUTES);e<f;e++)if(b=GL.getActiveAttrib(a,e),b!==null&&b!==-1&&b!==void 0)b={name:b.name,
size:b.size,type:b.type,location:GL.getAttribLocation(a,b.name),locationNumber:e},c[b.name]=b;else break;a.highestAttributeNumber=e-1;return c};b.createUniforms=function(a,c){var b,e={},f,i,h=0;for(b in a)if(f=a[b],i=f.name,c[i]===void 0)console.warn("GLOW.Compiler.createUniforms: missing declaration for uniform "+i);else if(c[i]instanceof GLOW.Uniform)e[i]=c[i];else if(e[i]=new GLOW.Uniform(f,c[i]),e[i].type===GL.SAMPLER_2D||e[i].type===GL.SAMPLER_CUBE)e[i].textureUnit=h++,e[i].data!==void 0&&e[i].data.init();
return e};b.createAttributes=function(a,c,b,e){var f,i,h,j={},e=e!==void 0?e:{},b=b!==void 0?b:{};for(f in a)i=a[f],h=i.name,c[h]===void 0?console.warn("GLOW.Compiler.createAttributes: missing data for attribute "+h):j[h]=c[h]instanceof GLOW.Attribute?c[h]:new GLOW.Attribute(i,c[h],b[h]!==void 0?b[h]:void 0,e[h]!==void 0?e[h]:!0);return j};b.interleaveAttributes=function(a,c){var c=c!==void 0?c:{},b,e,f,i,h;e=0;var j=[];for(b in a)c[b]!==void 0&&c[b]!==!1&&(e=Math.max(e-1,c[b])+1);for(b in a)c[b]===
void 0&&(c[b]=e);for(h in c)c[h]!==!1&&(j[c[h]]===void 0&&(j[c[h]]=[]),j[c[h]].push(a[h]));var k,l;b=0;for(e=j.length;b<e;b++)if(j[b]!==void 0){f=k=0;for(i=j[b].length;f<i;f++)if(k+j[b][f].size*4>255){console.warn("GLOW.Compiler.interleaveAttributes: Stride owerflow, moving attributes to new interleave index. Please check your interleave setup!");l=j.length;for(j[l]=[];f<i;)j[l].push(j[b][f]),j[b].splice(f,1),i--}else k+=j[b][f].size*4}l={};b=0;for(e=j.length;b<e;b++)if(j[b]!==void 0){k="";f=0;for(i=
j[b].length;f<i;f++)k+=f!==i-1?j[b][f].name+"_":j[b][f].name;l[k]=new GLOW.InterleavedAttributes(j[b])}for(h in c)c[h]!==!1&&delete a[h];return l};b.createElements=function(a,c,b){var e;a===void 0?console.error("GLOW.Compiler.createElements: missing 'elements' in supplied data. Quitting."):e=a instanceof GLOW.Elements?a:new GLOW.Elements(a,c,b!==void 0?b:GL.STATIC_DRAW);return e};return b}();
GLOW.CompiledData=function(){function b(a,c,b,e,f,i){this.program=a;this.uniforms=c!==void 0?c:{};this.attributes=b!==void 0?b:{};this.interleavedAttributes=e!==void 0?e:{};this.elements=f;i=i!==void 0?i:{};this.preDrawCallback=i.preDrawCallback;this.postDrawCallback=i.postDrawCallback;this.blend=i.blend;this.stencil=i.stencil}b.prototype.clone=function(a){var c=new GLOW.CompiledData,a=a!==void 0?a:{},b;for(b in this.uniforms)if(a[b]){if(c.uniforms[b]=new GLOW.Uniform(this.uniforms[b],a[b]),c.uniforms[b].type===
GL.SAMPLER_2D||c.uniforms[b].type===GL.SAMPLER_CUBE)c.uniforms[b].data.init(),c.uniforms[b].textureUnit=this.uniforms[b].textureUnit}else c.uniforms[b]=this.uniforms[b];for(var e in this.attributes)c.attributes[e]=a[e]?new GLOW.Attribute(this.attributes[e],a[e]):this.attributes[e];for(var f in this.interleavedAttributes)c.interleavedAttributes[f]=a[f]?a[f]:this.interleavedAttributes[f];c.elements=a.indices?new GLOW.Elements(a.indices,a.primitives):this.elements;c.program=a.program?a.program:this.program;
c.blend=a.blend?a.blend:this.blend;c.stencil=a.stencil?a.stencil:this.stencil;c.preDrawCallback=a.preDrawCallback?a.preDrawCallback:this.preDrawCallback;c.postDrawCallback=a.postDrawCallback?a.postDrawCallback:this.postDrawCallback;return c};return b}();
GLOW.Cache=function(){function b(){this.highestAttributeNumber=-1;this.uniformByLocation=[];this.attributeByLocation=[];this.textureByLocation=[];this.compiledCode=[];this.programId=this.elementId=-1;this.active=!0}b.prototype.codeCompiled=function(a,c){var b,e,f=this.compiledCode.length;for(e=0;e<f;e++)if(b=this.compiledCode[e],a===b.vertexShader&&c===b.fragmentShader)break;if(e===f)this.compiledCode.push({vertexShader:a,fragmentShader:c});else return this.compiledCode[e].program};b.prototype.addCompiledProgram=
function(a){this.compiledCode[this.compiledCode.length-1].program=a};b.prototype.programCached=function(a){if(this.active){if(a.id===this.programId)return!0;this.programId=a.id}return!1};b.prototype.setProgramHighestAttributeNumber=function(a){var c=this.highestAttributeNumber;this.highestAttributeNumber=a.highestAttributeNumber;return a.highestAttributeNumber-c};b.prototype.uniformCached=function(a){if(this.active){if(this.uniformByLocation[a.locationNumber]===a.id)return!0;this.uniformByLocation[a.locationNumber]=
a.id}return!1};b.prototype.invalidateUniform=function(a){this.uniformByLocation[a.locationNumber]=void 0};b.prototype.attributeCached=function(a){if(this.active){if(this.attributeByLocation[a.locationNumber]===a.id)return!0;this.attributeByLocation[a.locationNumber]=a.id}return!1};b.prototype.interleavedAttributeCached=function(a){if(this.active)for(var c=0,b=a.attributes.length,e;c<b;c++){e=a.attributes[c];if(this.attributeByLocation[e.locationNumber]===e.id)return!0;this.attributeByLocation[e.locationNumber]=
e.id}return!1};b.prototype.invalidateAttribute=function(a){this.attributeByLocation[a.locationNumber]=void 0};b.prototype.textureCached=function(a,c){if(this.active){if(this.textureByLocation[a]===c.id)return!0;this.textureByLocation[a]=c.id}return!1};b.prototype.invalidateTexture=function(a){this.textureByLocation[a]=void 0};b.prototype.elementsCached=function(a){if(this.active){if(a.id===this.elementId)return!0;this.elementId=a.id}return!1};b.prototype.invalidateElements=function(){this.elementId=
-1};b.prototype.clear=function(){this.highestAttributeNumber=-1;this.uniformByLocation.length=0;this.attributeByLocation.length=0;this.textureByLocation.length=0;this.programId=this.elementId=-1};return b}();
GLOW.FBO=function(){function b(c){c=c!==void 0?c:{};this.id=GLOW.uniqueId();this.width=c.width!==void 0?c.width:c.size!==void 0?c.size:window.innerWidth;this.height=c.height!==void 0?c.height:c.size!==void 0?c.size:window.innerHeight;var b=c.wrapS!==void 0?c.wrapS:c.wrap!==void 0?c.wrap:GL.CLAMP_TO_EDGE,e=c.wrapT!==void 0?c.wrapT:c.wrap!==void 0?c.wrap:GL.CLAMP_TO_EDGE,f=c.magFilter!==void 0?c.magFilter:GL.LINEAR,i=c.minFilter!==void 0?c.minFilter:GL.LINEAR,h=c.internalFormat!==void 0?c.internalFormat:
GL.RGBA,j=c.format!==void 0?c.format:GL.RGBA,k=c.type!==void 0?c.type:GL.UNSIGNED_BYTE,l=c.depth!==void 0?c.depth:!0,n=c.stencil!==void 0?c.stencil:!1,p=c.data!==void 0?c.data:null;this.isBound=!1;this.textureUnit=-1;this.textureType=c.cube!==!0?GL.TEXTURE_2D:GL.TEXTURE_CUBE_MAP;this.viewport=c.viewport?{x:c.viewport.x!==void 0?c.viewport.x:0,y:c.viewport.y!==void 0?c.viewport.y:0,width:c.viewport.width!==void 0?c.viewport.width:this.width,height:c.viewport.height!==void 0?c.viewport.height:this.height}:
{x:0,y:0,width:this.width,height:this.height};if(c.clear){if(this.clearSettings={r:c.clear.red!==void 0?c.clear.red:0,g:c.clear.green!==void 0?c.clear.green:0,b:c.clear.blue!==void 0?c.clear.blue:0,a:c.clear.alpha!==void 0?c.clear.alpha:1,depth:c.clear.depth!==void 0?c.clear.depth:1,bits:c.clear.bits!==void 0?c.clear.bits:-1},this.clearSettings.bits===-1)this.clearSettings.bits=GL.COLOR_BUFFER_BIT,this.clearSettings.bits|=l?GL.DEPTH_BUFFER_BIT:0,this.clearSettings.bits|=n?GL.STENCIL_BUFFER_BIT:0}else this.clearSettings=
{r:0,g:0,b:0,a:1,depth:1,bits:0},this.clearSettings.bits=GL.COLOR_BUFFER_BIT,this.clearSettings.bits|=l?GL.DEPTH_BUFFER_BIT:0,this.clearSettings.bits|=n?GL.STENCIL_BUFFER_BIT:0;this.texture=GL.createTexture();GL.bindTexture(this.textureType,this.texture);GL.texParameteri(this.textureType,GL.TEXTURE_WRAP_S,b);GL.texParameteri(this.textureType,GL.TEXTURE_WRAP_T,e);GL.texParameteri(this.textureType,GL.TEXTURE_MAG_FILTER,f);GL.texParameteri(this.textureType,GL.TEXTURE_MIN_FILTER,i);if(this.textureType===
GL.TEXTURE_2D)p===null||p instanceof Uint8Array?GL.texImage2D(this.textureType,0,h,this.width,this.height,0,j,k,p):GL.texImage2D(this.textureType,0,h,j,k,p);else for(var o in a)GL.texImage2D(GL.TEXTURE_CUBE_MAP_POSITIVE_X+a[o],0,h,this.width,this.height,0,j,k,p[o]);if(l||n)this.renderBuffer=GL.createRenderbuffer(),GL.bindRenderbuffer(GL.RENDERBUFFER,this.renderBuffer),l&&!n?GL.renderbufferStorage(GL.RENDERBUFFER,GL.DEPTH_COMPONENT16,this.width,this.height):!l&&n?GL.renderbufferStorage(GL.RENDERBUFFER,
GL.STENCIL_INDEX8,this.width,this.height):l&&n&&GL.renderbufferStorage(GL.RENDERBUFFER,GL.DEPTH_STENCIL,this.width,this.height);if(this.textureType===GL.TEXTURE_2D)this.frameBuffer=GL.createFramebuffer(),GL.bindFramebuffer(GL.FRAMEBUFFER,this.frameBuffer),GL.framebufferTexture2D(GL.FRAMEBUFFER,GL.COLOR_ATTACHMENT0,GL.TEXTURE_2D,this.texture,0),l&&!n?GL.framebufferRenderbuffer(GL.FRAMEBUFFER,GL.DEPTH_ATTACHMENT,GL.RENDERBUFFER,this.renderBuffer):!l&&n?GL.framebufferRenderbuffer(GL.FRAMEBUFFER,GL.STENCIL_ATTACHMENT,
GL.RENDERBUFFER,this.renderBuffer):l&&n&&GL.framebufferRenderbuffer(GL.FRAMEBUFFER,GL.DEPTH_STENCIL_ATTACHMENT,GL.RENDERBUFFER,this.renderBuffer);else{this.frameBuffers={};for(var r in a)this.frameBuffers[r]=GL.createFramebuffer(),GL.bindFramebuffer(GL.FRAMEBUFFER,this.frameBuffers[r]),GL.framebufferTexture2D(GL.FRAMEBUFFER,GL.COLOR_ATTACHMENT0,GL.TEXTURE_CUBE_MAP_POSITIVE_X+a[r],this.texture,0),l&&!n?GL.framebufferRenderbuffer(GL.FRAMEBUFFER,GL.DEPTH_ATTACHMENT,GL.RENDERBUFFER,this.renderBuffer):
!l&&n?GL.framebufferRenderbuffer(GL.FRAMEBUFFER,GL.STENCIL_ATTACHMENT,GL.RENDERBUFFER,this.renderBuffer):l&&n&&GL.framebufferRenderbuffer(GL.FRAMEBUFFER,GL.DEPTH_STENCIL_ATTACHMENT,GL.RENDERBUFFER,this.renderBuffer)}GL.bindTexture(this.textureType,null);GL.bindRenderbuffer(GL.RENDERBUFFER,null);GL.bindFramebuffer(GL.FRAMEBUFFER,null)}var a={posX:0,negX:1,posY:2,negY:3,posZ:4,negZ:5};b.prototype.init=function(){};b.prototype.bind=function(a,b){if(!this.isBound)this.isBound=!0,(a||a===void 0)&&this.setupViewport(a),
this.textureType===GL.TEXTURE_2D?GL.bindFramebuffer(GL.FRAMEBUFFER,this.frameBuffer):GL.bindFramebuffer(GL.FRAMEBUFFER,this.frameBuffers[b!==void 0?b:"posX"]);return this};b.prototype.unbind=function(a){if(this.isBound)this.isBound=!1,GL.bindFramebuffer(GL.FRAMEBUFFER,null),(a===void 0||a===!0)&&GL.viewport(GLOW.currentContext.viewport.x,GLOW.currentContext.viewport.y,GLOW.currentContext.viewport.width,GLOW.currentContext.viewport.height);return this};b.prototype.setViewport=function(){this.setupViewport()};
b.prototype.setupViewport=function(a){if(a)this.viewport.x=a.x!==void 0?a.x:this.viewport.x,this.viewport.y=a.y!==void 0?a.y:this.viewport.y,this.viewport.width=a.width!==void 0?a.width:this.viewport.width,this.viewport.height=a.height!==void 0?a.height:this.viewport.height;GL.viewport(this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height);return this};b.prototype.setupClear=function(a){if(a!==void 0)this.clearSettings.r=a.red!==void 0?Math.min(1,Math.max(0,a.red)):this.clearSettings.r,
this.clearSettings.g=a.green!==void 0?Math.min(1,Math.max(0,a.green)):this.clearSettings.g,this.clearSettings.b=a.blue!==void 0?Math.min(1,Math.max(0,a.blue)):this.clearSettings.b,this.clearSettings.a=a.alpha!==void 0?Math.min(1,Math.max(0,a.alpha)):this.clearSettings.a,this.clearSettings.depth=a.depth!==void 0?Math.min(1,Math.max(0,a.depth)):this.clearSettings.depth,this.clearSettings.bits=a.bits!==void 0?a.bits:this.clearSettings.bits;GL.clearColor(this.clearSettings.r,this.clearSettings.g,this.clearSettings.b,
this.clearSettings.a);GL.clearDepth(this.clearSettings.depth);return this};b.prototype.clear=function(a){this.isBound&&(this.setupClear(a),GL.clear(this.clearSettings.bits));return this};b.prototype.resize=function(){return this};b.prototype.generateMipMaps=function(){GL.bindTexture(this.textureType,this.texture);GL.generateMipmap(this.textureType);GL.bindTexture(this.textureType,null);return this};return b}();
GLOW.Texture=function(){function b(a){if(a.url!==void 0)a.data=a.url;this.id=GLOW.uniqueId();this.data=a.data;this.autoUpdate=a.autoUpdate;this.internalFormat=a.internalFormat!==void 0?a.internalFormat:GL.RGBA;this.format=a.format!==void 0?a.format:GL.RGBA;this.type=a.type!==void 0?a.type:GL.UNSIGNED_BYTE;this.wrapS=a.wrapS!==void 0?a.wrapS:a.wrap!==void 0?a.wrap:GL.REPEAT;this.wrapT=a.wrapT!==void 0?a.wrapT:a.wrap!==void 0?a.wrap:GL.REPEAT;this.magFilter=a.magFilter!==void 0?a.magFilter:GL.LINEAR;
this.minFilter=a.minFilter!==void 0?a.minFilter:GL.LINEAR_MIPMAP_LINEAR;this.width=a.width;this.height=a.height;this.texture=void 0}var a={posX:0,negX:1,posY:2,negY:3,posZ:4,negZ:5};b.prototype.init=function(){if(this.texture===void 0)if(this.data===void 0&&this.width!==void 0&&this.height!==void 0)this.data=this.type===GL.UNSIGNED_BYTE?new Uint8Array(this.width*this.height*(this.format===GL.RGBA?4:3)):new Float32Array(this.width*this.height*(this.format===GL.RGBA?4:3));else if(typeof this.data===
"string"){this.textureType=GL.TEXTURE_2D;var c=this.data,b=c.toLowerCase();if(b.indexOf(".jpg")!==-1||b.indexOf(".png")!==-1||b.indexOf(".gif")!==-1||b.indexOf("jpeg")!==-1)this.data=new Image,this.data.scope=this,this.data.onload=this.onLoadImage;else{if(this.autoUpdate===void 0)this.autoUpdate=!0;this.data=document.createElement("video");this.data.scope=this;this.data.addEventListener("loadeddata",this.onLoadVideo,!1)}this.data.src=c}else if(this.data instanceof HTMLImageElement||this.data instanceof
HTMLVideoElement||this.data instanceof HTMLCanvasElement||this.data instanceof Uint8Array||this.data instanceof Float32Array)this.textureType=GL.TEXTURE_2D,this.createTexture();else{this.textureType=GL.TEXTURE_CUBE_MAP;this.itemsToLoad=0;for(var e in a)this.data[e]!==void 0?typeof this.data[e]==="string"&&this.itemsToLoad++:console.error("GLOW.Texture.init: data type error. Did you forget cube map "+e+"? If not, the data type is not supported");if(this.itemsToLoad===0)this.createTexture();else for(e in a)if(typeof this.data[e]===
"string")c=this.data[e],b=c.toLowerCase(),b.indexOf(".jpg")!==-1||b.indexOf(".png")!==-1||b.indexOf(".gif")!==-1||b.indexOf("jpeg")!==-1?(this.data[e]=new Image,this.data[e].scope=this,this.data[e].onload=this.onLoadCubeImage):(this.autoUpdate!==void 0?this.autoUpdate[e]=this.autoUpdate[e]!==void 0?this.autoUpdate[e]:!0:(this.autoUpdate={},this.autoUpdate[e]=!0),this.data[e]=document.createElement("video"),this.data[e].scope=this,this.data[e].addEventListener("loadeddata",this.onLoadCubeVideo,!1)),
this.data[e].src=c}};b.prototype.createTexture=function(){this.texture=GL.createTexture();GL.bindTexture(this.textureType,this.texture);if(this.textureType===GL.TEXTURE_2D)if(this.data instanceof Uint8Array)if(this.width!==void 0&&this.height!==void 0)GL.texImage2D(this.textureType,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.data);else{console.error("GLOW.Texture.createTexture: Textures of type Uint8Array requires width and height parameters. Quitting.");return}else GL.texImage2D(this.textureType,
0,this.internalFormat,this.format,this.type,this.data);else for(var c in a)if(this.data[c]instanceof Uint8Array||this.data[c]instanceof Float32Array)if(this.width!==void 0&&this.height!==void 0)GL.texImage2D(GL.TEXTURE_CUBE_MAP_POSITIVE_X+a[c],0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.data[c]);else{console.error("GLOW.Texture.createTexture: Textures of type Uint8Array/Float32Array requires width and height parameters. Quitting.");return}else GL.texImage2D(GL.TEXTURE_CUBE_MAP_POSITIVE_X+
a[c],0,this.internalFormat,this.format,this.type,this.data[c]);GL.texParameteri(this.textureType,GL.TEXTURE_WRAP_S,this.wrapS);GL.texParameteri(this.textureType,GL.TEXTURE_WRAP_T,this.wrapT);GL.texParameteri(this.textureType,GL.TEXTURE_MIN_FILTER,this.minFilter);GL.texParameteri(this.textureType,GL.TEXTURE_MAG_FILTER,this.magFilter);this.minFilter!==GL.NEAREST&&this.minFilter!==GL.LINEAR&&GL.generateMipmap(this.textureType)};b.prototype.updateTexture=function(c){if(this.texture!==void 0){var c=c!==
void 0?c:{},b=c.level!==void 0?c.level:0,e=c.xOffset!==void 0?c.xOffset:0,f=c.yOffset!==void 0?c.yOffset:0,i=c.updateMipmap!==void 0?c.updateMipmap:!0;GL.bindTexture(this.textureType,this.texture);if(this.textureType==GL.TEXTURE_2D)this.data instanceof Uint8Array?GL.texSubImage2D(this.textureType,b,e,f,this.width,this.height,this.format,this.type,this.data):GL.texSubImage2D(this.textureType,b,e,f,this.format,this.type,this.data);else for(var h in c)a[h]!==void 0&&(this.data[h]instanceof Uint8Array?
GL.texSubImage2D(GL.TEXTURE_CUBE_MAP_POSITIVE_X+a[h],b,e,f,this.width,this.height,this.format,this.type,this.data[h]):GL.texSubImage2D(GL.TEXTURE_CUBE_MAP_POSITIVE_X+a[h],b,e,f,this.format,this.type,this.data[h]));this.minFilter!==GL.NEAREST&&this.minFilter!==GL.LINEAR&&i===!0&&GL.generateMipmap(this.textureType)}};b.prototype.onLoadImage=function(){this.scope.createTexture()};b.prototype.onLoadCubeImage=function(){this.scope.itemsToLoad--;this.scope.itemsToLoad===0&&this.scope.createTexture()};b.prototype.onLoadVideo=
function(){this.removeEventListener("loadeddata",this.scope.onLoadVideo,!1);this.scope.createTexture()};b.prototype.onLoadCubeVideo=function(){this.removeEventListener("loadeddata",this.scope.onLoadVideo,!1);this.scope.itemsToLoad--;this.scope.itemsToLoad===0&&this.scope.createTexture()};b.prototype.play=function(){if(this.textureType===GL.TEXTURE_2D)this.data instanceof HTMLVideoElement&&this.data.play();else for(var c in a)this.data[c]instanceof HTMLVideoElement&&this.data[c].play()};return b}();
GLOW.Shader=function(){function b(a){this.id=GLOW.uniqueId();this.compiledData=a.use?a.use.clone(a.except):GLOW.Compiler.compile(a);this.attachData()}b.prototype.attachData=function(){var a,c,b;this.uniforms=this.compiledData.uniforms;this.elements=this.compiledData.elements;this.program=this.compiledData.program;for(a in this.compiledData.uniforms)this[a]===void 0?this[a]=this.compiledData.uniforms[a].data:console.warn("GLOW.Shader.attachUniformAndAttributeData: name collision on uniform "+a+", not attaching for easy access. Please use Shader.uniforms."+
a+".data to access data.");for(c in this.compiledData.attributes){if(this.attributes===void 0)this.attributes=this.compiledData.attributes;this[c]===void 0?this[c]=this.compiledData.attributes[c]:console.warn("GLOW.Shader.attachUniformAndAttributeData: name collision on attribute "+c+", not attaching for easy access. Please use Shader.attributes."+c+".data to access data.")}for(b in this.compiledData.interleavedAttributes){if(this.interleavedAttributes===void 0)this.interleavedAttributes=this.compiledData.interleavedAttributes;
this[b]===void 0?this[b]=this.compiledData.interleavedAttributes[b]:console.warn("GLOW.Shader.attachUniformAndAttributeData: name collision on interleavedAttribute "+c+", not attaching for easy access. Please use Shader.interleavedAttributes."+c+".data to access data.")}};b.prototype.draw=function(){var a=this.compiledData,c=GLOW.currentContext.cache;a.preDrawCallback&&a.preDrawCallback(this);if(!c.programCached(a.program)){GL.useProgram(a.program);var b=c.setProgramHighestAttributeNumber(a.program);
if(b){var e=a.program.highestAttributeNumber,f=e-b+1;if(b>0)for(;f<=e;f++)GL.enableVertexAttribArray(f);else for(f--;f>e;f--)GL.disableVertexAttribArray(f)}}for(var i in a.attributes)a.attributes[i].interleaved===!1&&(c.attributeCached(a.attributes[i])||a.attributes[i].bind());for(i in a.interleavedAttributes)c.interleavedAttributeCached(a.interleavedAttributes[i])||a.interleavedAttributes[i].bind();for(var h in a.uniforms)c.uniformCached(a.uniforms[h])||a.uniforms[h].load();a.elements.draw();a.postDrawCallback&&
a.postDrawCallback(this)};b.prototype.clone=function(a){return new GLOW.Shader({use:this.compiledData,except:a})};b.prototype.dispose=function(){};return b}();
GLOW.Elements=function(){function b(a,c,b,e){this.id=GLOW.uniqueId();this.type=c!==void 0?c:GL.TRIANGLES;this.offset=e!==void 0?e:0;typeof a==="number"?this.length=a:(a instanceof Uint16Array||(a=new Uint16Array(a)),this.length=a.length,this.elements=GL.createBuffer(),GL.bindBuffer(GL.ELEMENT_ARRAY_BUFFER,this.elements),GL.bufferData(GL.ELEMENT_ARRAY_BUFFER,a,b?b:GL.STATIC_DRAW))}b.prototype.draw=function(){this.elements!==void 0?(GLOW.currentContext.cache.elementsCached(this)||GL.bindBuffer(GL.ELEMENT_ARRAY_BUFFER,
this.elements),GL.drawElements(this.type,this.length,GL.UNSIGNED_SHORT,this.offset)):GL.drawArrays(this.type,this.offset,this.length)};b.prototype.dispose=function(){};return b}();
GLOW.Uniform=function(){function b(){g[GL.INT]=function(){GL.uniform1iv(this.location,this.getNativeValue())};g[GL.FLOAT]=function(){GL.uniform1fv(this.location,this.getNativeValue())};g[GL.INT_VEC2]=function(){GL.uniform2iv(this.location,this.getNativeValue())};g[GL.INT_VEC3]=function(){GL.uniform3iv(this.location,this.getNativeValue())};g[GL.INT_VEC4]=function(){GL.uniform4iv(this.location,this.getNativeValue())};g[GL.BOOL]=function(){GL.uniform1iv(this.location,this.getNativeValue())};g[GL.BOOL_VEC2]=
function(){GL.uniform2iv(this.location,this.getNativeValue())};g[GL.BOOL_VEC3]=function(){GL.uniform3iv(this.location,this.getNativeValue())};g[GL.BOOL_VEC4]=function(){GL.uniform4iv(this.location,this.getNativeValue())};g[GL.FLOAT_VEC2]=function(){GL.uniform2fv(this.location,this.getNativeValue())};g[GL.FLOAT_VEC3]=function(){GL.uniform3fv(this.location,this.getNativeValue())};g[GL.FLOAT_VEC4]=function(){GL.uniform4fv(this.location,this.getNativeValue())};g[GL.FLOAT_MAT2]=function(){GL.uniformMatrix2fv(this.location,
!1,this.getNativeValue())};g[GL.FLOAT_MAT3]=function(){GL.uniformMatrix3fv(this.location,!1,this.getNativeValue())};g[GL.FLOAT_MAT4]=function(){GL.uniformMatrix4fv(this.location,!1,this.getNativeValue())};g[GL.SAMPLER_2D]=function(){this.data.texture!==void 0&&this.textureUnit!==-1&&!GLOW.currentContext.cache.textureCached(this.textureUnit,this.data)&&(GL.uniform1i(this.location,this.textureUnit),GL.activeTexture(GL.TEXTURE0+this.textureUnit),GL.bindTexture(GL.TEXTURE_2D,this.data.texture),this.data.autoUpdate&&
this.data.updateTexture(this.data.autoUpdate))};g[GL.SAMPLER_CUBE]=function(){this.data.texture!==void 0&&this.textureUnit!==-1&&!GLOW.currentContext.cache.textureCached(this.textureUnit,this.data)&&(GL.uniform1i(this.location,this.textureUnit),GL.activeTexture(GL.TEXTURE0+this.textureUnit),GL.bindTexture(GL.TEXTURE_CUBE_MAP,this.data.texture),this.data.autoUpdate&&this.data.updateTexture(this.data.autoUpdate))}}function a(a,f){c||(c=!0,b());this.id=GLOW.uniqueId();this.data=f;this.name=a.name;this.length=
a.length;this.type=a.type;this.location=a.location;this.locationNumber=a.locationNumber;this.textureUnit=-1;this.load=a.loadFunction||g[this.type]}var c=!1,g=[];a.prototype.getNativeValue=function(){return this.data.value};return a}();
GLOW.Attribute=function(){function b(b,e,f,i){a||(a=!0,c[GL.INT]=1,c[GL.INT_VEC2]=2,c[GL.INT_VEC3]=3,c[GL.INT_VEC4]=4,c[GL.BOOL]=1,c[GL.BOOL_VEC2]=2,c[GL.BOOL_VEC3]=3,c[GL.BOOL_VEC4]=4,c[GL.FLOAT]=1,c[GL.FLOAT_VEC2]=2,c[GL.FLOAT_VEC3]=3,c[GL.FLOAT_VEC4]=4,c[GL.FLOAT_MAT2]=4,c[GL.FLOAT_MAT3]=9,c[GL.FLOAT_MAT4]=16);this.id=GLOW.uniqueId();this.data=e;this.location=b.location;this.locationNumber=b.locationNumber;this.offset=this.stride=0;this.usage=f!==void 0?f:GL.STATIC_DRAW;this.interleaved=i!==void 0?
i:!1;this.size=c[b.type];this.name=b.name;this.type=b.type;this.data.length/this.size>65536&&console.warn("GLOW.Attribute.constructor: Unreachable attribute? Please activate GL.drawArrays or split into multiple shaders. Indexed elements cannot reach attribute data beyond 65535.");if(this.data.constructor.toString().indexOf(" Array()")!==-1)this.data=new Float32Array(this.data);this.interleaved===!1&&this.bufferData(this.data,this.usage)}var a=!1,c=[];b.prototype.setupInterleave=function(a,b){this.interleaved=
!0;this.offset=a;this.stride=b};b.prototype.bufferData=function(a,b){if(a!==void 0&&this.data!==a)this.data=a;if(b!==void 0&&this.usage!==b)this.usage=b;if(this.buffer===void 0)this.buffer=GL.createBuffer();GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);GL.bufferData(GL.ARRAY_BUFFER,this.data,this.usage)};b.prototype.bind=function(){this.interleaved===!1&&GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);GL.vertexAttribPointer(this.location,this.size,GL.FLOAT,!1,this.stride,this.offset)};b.prototype.clone=function(){this.interleaved?
console.error("GLOW.Attribute.clone: Cannot clone interleaved attribute. Please check your interleave setup."):new GLOW.Attribute(this,this.data,this.usage,this.interleaved)};b.prototype.dispose=function(){};return b}();
GLOW.InterleavedAttributes=function(){function b(a){this.id=GLOW.uniqueId();this.attributes=a;var b,g=a[0].data.length/a[0].size,e,f=a.length,i,h,j,k=[],l,n=[];for(e=0;e<f;e++)k[e]=0;for(b=0;b<g;b++)for(e=0;e<f;e++){l=a[e].data;j=k[e];i=0;for(h=a[e].size;i<h;i++)n.push(l[j++]);k[e]=j}this.data=new Float32Array(n);this.usage=a[0].usage;for(e=0;e<f;e++)if(this.usage!==a[e].usage){console.warn("GLOW.InterleavedAttributes.construct: Attribute "+a[e].name+" has different usage, defaulting to STATIC_DRAW.");
this.usage=GL.STATIC_DRAW;break}this.bufferData(this.data,this.usage);for(e=b=0;e<f;e++)b+=a[e].size*4;for(e=g=0;e<f;e++)a[e].setupInterleave(g,b),g+=a[e].size*4}b.prototype.bufferData=function(a,b){if(a!==void 0&&this.data!==a)this.data=a;if(this.buffer===void 0)this.buffer=GL.createBuffer();GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);GL.bufferData(GL.ARRAY_BUFFER,this.data,b?b:GL.STATIC_DRAW)};b.prototype.bind=function(){GL.bindBuffer(GL.ARRAY_BUFFER,this.buffer);var a,b=this.attributes.length;for(a=
0;a<b;a++)this.attributes[a].bind()};return b}();
GLOW.Float=function(){function b(a){a!==void 0&&a.length?this.value=new Float32Array(a):(this.value=new Float32Array(1),this.value[0]=a!==void 0?a:0)}b.prototype.set=function(a){this.value[0]=a;return this};b.prototype.add=function(a){this.value[0]+=a;return this};b.prototype.sub=function(a){this.value[0]-=a;return this};b.prototype.multiply=function(a){this.value[0]*=a;return this};b.prototype.divide=function(a){this.value[0]/=a;return this};b.prototype.modulo=function(a){this.value[0]%=a;return this};
return b}();
GLOW.Int=function(){function b(a){a!==void 0&&a.length?this.value=new Int32Array(a):(this.value=new Int32Array(1),this.value[0]=a!==void 0?a:0)}b.prototype.set=function(a){this.value[0]=a;return this};b.prototype.add=function(a){this.value[0]+=a;return this};b.prototype.sub=function(a){this.value[0]-=a;return this};b.prototype.multiply=function(a){this.value[0]*=a;return this};b.prototype.divide=function(a){this.value[0]/=a;return this};b.prototype.modulo=function(a){this.value[0]%=a;return this};
return b};GLOW.Bool=function(){function b(a){this.value=[];this.value[0]=a!==void 0?!!a:!1}b.prototype.set=function(a){this.value[0]=!!a;return this};return b}();GLOW.Bool2=function(){function b(a,b){this.value=[];this.value[0]=a!==void 0?!!a:!1;this.value[1]=b!==void 0?!!b:!1}b.prototype.set=function(a,b){this.value[0]=!!a;this.value[1]=!!b;return this};return b}();
GLOW.Bool3=function(){function b(a,b,g){this.value=[];this.value[0]=a!==void 0?!!a:!1;this.value[1]=b!==void 0?!!b:!1;this.value[2]=g!==void 0?!!g:!1}b.prototype.set=function(a,b,g){this.value[0]=!!a;this.value[1]=!!b;this.value[2]=!!g;return this};return b}();
GLOW.Bool4=function(){function b(a,b,g,e){this.value=[];this.value[0]=a!==void 0?!!a:!1;this.value[1]=b!==void 0?!!b:!1;this.value[2]=g!==void 0?!!g:!1;this.value[3]=e!==void 0?!!e:!1}b.prototype.set=function(a,b,g,e){this.value[0]=!!a;this.value[1]=!!b;this.value[2]=!!g;this.value[3]=!!e;return this};return b}();
GLOW.Vector2=function(){function b(a,b){this.value=new Float32Array(2);this.value[0]=a!==void 0?a:0;this.value[1]=b!==void 0?b:0}b.prototype.set=function(a,b){this.value[0]=a;this.value[1]=b;return this};b.prototype.copy=function(a){this.value[0]=a.value[0];this.value[1]=a.value[1];return this};b.prototype.addSelf=function(a){this.value[0]+=a.value[0];this.value[1]+=a.value[1];return this};b.prototype.add=function(a,b){this.value[0]=a.value[0]+b.value[0];this.value[1]=a.value[1]+b.value[1];return this};
b.prototype.subSelf=function(a){this.value[0]-=a.x;this.value[1]-=a.y;return this};b.prototype.sub=function(a,b){this.value[0]=a.value[0]-b.value[0];this.value[1]=a.value[1]-b.value[1];return this};b.prototype.multiplySelf=function(a){this.value[0]*=a.value[0];this.value[1]*=a.value[1];return this};b.prototype.multiply=function(a,b){this.value[0]=a.value[0]*b.value[0];this.value[1]=a.value[1]*b.value[1];return this};b.prototype.multiplyScalar=function(a){this.value[0]*=a;this.value[1]*=a;return this};
b.prototype.negate=function(){this.value[0]=-this.value[0];this.value[1]=-this.value[1];return this};b.prototype.normalize=function(){this.multiplyScalar(1/this.length());return this};b.prototype.length=function(){return Math.sqrt(this.lengthSq())};b.prototype.lengthSq=function(){return this.value[0]*this.value[0]+this.value[1]*this.value[1]};b.prototype.clone=function(){return new GLOW.Vector2(this.value[0],this.value[1])};return b}();
GLOW.Vector3=function(){function b(a,b,g){this.value=new Float32Array(3);this.value[0]=a!==void 0?a:0;this.value[1]=b!==void 0?b:0;this.value[2]=g!==void 0?g:0}b.prototype.set=function(a,b,g){this.value[0]=a;this.value[1]=b;this.value[2]=g;return this};b.prototype.copy=function(){this.set(this.value[0],this.value[1],this.value[2]);return this};b.prototype.add=function(a,b){a=a.value;b=b.value;this.value[0]=a[0]+b[0];this.value[1]=a[1]+b[1];this.value[2]=a[2]+b[2];return this};b.prototype.addSelf=
function(a){a=a.value;this.value[0]+=a[0];this.value[1]+=a[1];this.value[2]+=a[2];return this};b.prototype.addScalar=function(a){this.value[0]+=a;this.value[1]+=a;this.value[2]+=a;return this};b.prototype.sub=function(a,b){a=a.value;b=b.value;this.value[0]=a[0]-b[0];this.value[1]=a[1]-b[1];this.value[2]=a[2]-b[2];return this};b.prototype.subSelf=function(a){a=a.value;this.value[0]-=a[0];this.value[1]-=a[1];this.value[2]-=a[2];return this};b.prototype.cross=function(a,b){a=a.value;b=b.value;this.value[0]=
a[1]*b[2]-a[2]*b[1];this.value[1]=a[2]*b[0]-a[0]*b[2];this.value[2]=a[0]*b[1]-a[1]*b[0];return this};b.prototype.crossSelf=function(a){var a=a.value,b=a[0],g=a[1],a=a[2],e=this.value[0],f=this.value[1],i=this.value[2];this.value[0]=g*i-a*f;this.value[1]=a*e-b*i;this.value[2]=b*f-g*e;return this};b.prototype.multiply=function(a,b){a=a.value;b=b.value;this.value[0]=a[0]*b[0];this.value[1]=a[1]*b[1];this.value[2]=a[2]*b[2];return this};b.prototype.multiplySelf=function(a){a=a.value;this.value[0]*=a[0];
this.value[1]*=a[1];this.value[2]*=a[2];return this};b.prototype.multiplyScalar=function(a){this.value[0]*=a;this.value[1]*=a;this.value[2]*=a;return this};b.prototype.divideSelf=function(a){a=a.value;this.value[0]/=a[0];this.value[1]/=a[1];this.value[2]/=a[2];return this};b.prototype.divideScalar=function(a){this.value[0]/=a;this.value[1]/=a;this.value[2]/=a;return this};b.prototype.negate=function(){this.value[0]=-this.value[0];this.value[1]=-this.value[1];this.value[2]=-this.value[2];return this};
b.prototype.dot=function(a){a=a.value;return this.value[0]*a[0]+this.value[1]*a[1]+this.value[2]*a[2]};b.prototype.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))};b.prototype.distanceToSquared=function(a){var a=a.value,b=this.value[0]-a[0],g=this.value[1]-a[1],a=this.value[2]-a[2];return b*b+g*g+a*a};b.prototype.length=function(){return Math.sqrt(this.lengthSq())};b.prototype.lengthSq=function(){return this.value[0]*this.value[0]+this.value[1]*this.value[1]+this.value[2]*this.value[2]};
b.prototype.lengthManhattan=function(){return this.value[0]+this.value[1]+this.value[2]};b.prototype.normalize=function(){var a=Math.sqrt(this.value[0]*this.value[0]+this.value[1]*this.value[1]+this.value[2]*this.value[2]);a>0?this.multiplyScalar(1/a):this.set(0,0,0);return this};b.prototype.setPositionFromMatrix=function(a){a=a.value;this.value[0]=a[12];this.value[1]=a[13];this.value[2]=a[14]};b.prototype.setLength=function(a){return this.normalize().multiplyScalar(a)};b.prototype.isZero=function(){return Math.abs(this.value[0])<
1.0E-4&&Math.abs(this.value[1])<1.0E-4&&Math.abs(this.value[2])<1.0E-4};b.prototype.clone=function(){return GLOW.Vector3(this.value[0],this.value[1],this.value[2])};return b}();
GLOW.Vector4=function(){function b(a,b,g,e){this.value=new Float32Array(4);this.value[0]=a!==void 0?a:0;this.value[1]=b!==void 0?b:0;this.value[2]=g!==void 0?g:0;this.value[3]=e!==void 0?e:0}b.prototype.set=function(a,b,g,e){this.value[0]=a;this.value[1]=b;this.value[2]=g;this.value[3]=e;return this};b.prototype.copy=function(a){this.value[0]=a.value[0];this.value[1]=a.value[1];this.value[2]=a.value[2];this.value[3]=a.value[3];return this};b.prototype.add=function(a,b){this.value[0]=a.value[0]+b.value[0];
this.value[1]=a.value[1]+b.value[1];this.value[2]=a.value[2]+b.value[2];this.value[3]=a.value[3]+b.value[3];return this};b.prototype.addSelf=function(a){this.value[0]+=a.value[0];this.value[1]+=a.value[1];this.value[2]+=a.value[2];this.value[3]+=a.value[3];return this};b.prototype.sub=function(a,b){this.value[0]=a.value[0]-b.value[0];this.value[1]=a.value[1]-b.value[1];this.value[2]=a.value[2]-b.value[2];this.value[3]=a.value[3]-b.value[3];return this};b.prototype.subSelf=function(a){this.value[0]-=
a.value[0];this.value[1]-=a.value[1];this.value[2]-=a.value[2];this.value[3]-=a.value[3];return this};b.prototype.multiplyScalar=function(a){this.value[0]*=a;this.value[1]*=a;this.value[2]*=a;this.value[3]*=a;return this};b.prototype.divideScalar=function(a){this.value[0]/=a;this.value[1]/=a;this.value[2]/=a;this.value[3]/=a;return this};b.prototype.lerpSelf=function(a,b){this.value[0]+=(a.x-this.value[0])*b;this.value[1]+=(a.y-this.value[1])*b;this.value[2]+=(a.z-this.value[2])*b;this.value[3]+=
(a.w-this.value[3])*b;return this};b.prototype.clone=function(){return new GLOW.Vector4(this.value[0],this.value[1],this.value[2],this.value[3])};return b}();
GLOW.Matrix3=function(){function b(){this.value=new Float32Array(9);this.identity()}b.prototype.set=function(a,b,g,e,f,i,h,j,k){this.value[0]=a;this.value[3]=b;this.value[6]=g;this.value[1]=e;this.value[4]=f;this.value[7]=i;this.value[2]=h;this.value[5]=j;this.value[8]=k;return this};b.prototype.identity=function(){this.set(1,0,0,0,1,0,0,0,1);return this};b.prototype.extractFromMatrix4=function(a){this.set(a.value[0],a.value[4],a.value[8],a.value[1],a.value[5],a.value[9],a.value[2],a.value[6],a.value[10]);
return this};return b}();
GLOW.Matrix4=function(){function b(){this.value=new Float32Array(16);this.rotation=new GLOW.Vector3;this.position=new GLOW.Vector3;this.columnX=new GLOW.Vector3;this.columnY=new GLOW.Vector3;this.columnZ=new GLOW.Vector3;this.identity()}b.prototype.set=function(a,b,g,e,f,i,h,j,k,l,n,p,o,r,q,s){this.value[0]=a;this.value[4]=b;this.value[8]=g;this.value[12]=e;this.value[1]=f;this.value[5]=i;this.value[9]=h;this.value[13]=j;this.value[2]=k;this.value[6]=l;this.value[10]=n;this.value[14]=p;this.value[3]=
o;this.value[7]=r;this.value[11]=q;this.value[15]=s;return this};b.prototype.identity=function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this};b.prototype.copy=function(a){a=a.value;this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]);return this};b.prototype.lookAt=function(a,b){var g=GLOW.Matrix4.tempVector3A,e=GLOW.Matrix4.tempVector3B,f=GLOW.Matrix4.tempVector3C,i=this.getPosition();i.value[0]=this.value[12];i.value[1]=this.value[13];i.value[2]=
this.value[14];f.sub(i,a).normalize();f.length()===0&&(f.value[3]=1);g.cross(b,f).normalize();g.length()===0&&(f.value[0]+=1.0E-4,g.cross(b,f).normalize());e.cross(f,g).normalize();g=g.value;e=e.value;f=f.value;this.value[0]=g[0];this.value[4]=e[0];this.value[8]=f[0];this.value[1]=g[1];this.value[5]=e[1];this.value[9]=f[1];this.value[2]=g[2];this.value[6]=e[2];this.value[10]=f[2];return this};b.prototype.multiplyVector3=function(a){var b=a.value[0],g=a.value[1],e=a.value[2],f=1/(this.value[3]*b+this.value[7]*
g+this.value[11]*e+this.value[15]);a.value[0]=(this.value[0]*b+this.value[4]*g+this.value[8]*e+this.value[12])*f;a.value[1]=(this.value[1]*b+this.value[5]*g+this.value[9]*e+this.value[13])*f;a.value[2]=(this.value[2]*b+this.value[6]*g+this.value[10]*e+this.value[14])*f;return a};b.prototype.multiplyVector4=function(a){var b=a.value[0],g=a.value[1],e=a.value[2],f=a.value[3];a.value[0]=this.value[0]*b+this.value[4]*g+this.value[8]*e+this.value[12]*f;a.value[1]=this.value[1]*b+this.value[5]*g+this.value[9]*
e+this.value[13]*f;a.value[2]=this.value[2]*b+this.value[6]*g+this.value[10]*e+this.value[14]*f;a.value[3]=this.value[3]*b+this.value[7]*g+this.value[11]*e+this.value[15]*f;return a};b.prototype.rotateAxis=function(a){var b=a.value[0],g=a.value[1],e=a.value[2];a.value[0]=b*this.value[0]+g*this.value[4]+e*this.value[8];a.value[1]=b*this.value[1]+g*this.value[5]+e*this.value[9];a.value[2]=b*this.value[2]+g*this.value[6]+e*this.value[10];a.normalize();return a};b.prototype.crossVector=function(a){var b=
GLOW.Vector4(),g=a.value[0],e=a.value[1],f=a.value[2],a=a.value[3];b.value[0]=this.value[0]*g+this.value[4]*e+this.value[8]*f+this.value[12]*a;b.value[1]=this.value[1]*g+this.value[5]*e+this.value[9]*f+this.value[13]*a;b.value[2]=this.value[2]*g+this.value[6]*e+this.value[10]*f+this.value[14]*a;b.value[3]=a?this.value[3]*g+this.value[7]*e+this.value[11]*f+this.value[15]*a:1;return b};b.prototype.multiply=function(a,b){var a=a.value,b=b.value,g=a[0],e=a[4],f=a[8],i=a[12],h=a[1],j=a[5],k=a[9],l=a[13],
n=a[2],p=a[6],o=a[10],r=a[14],q=a[3],s=a[7],t=a[11],u=a[15],v=b[0],w=b[4],y=b[8],x=b[12],z=b[1],A=b[5],B=b[9],C=b[13],D=b[2],E=b[6],F=b[10],G=b[14];this.value[0]=g*v+e*z+f*D;this.value[4]=g*w+e*A+f*E;this.value[8]=g*y+e*B+f*F;this.value[12]=g*x+e*C+f*G+i;this.value[1]=h*v+j*z+k*D;this.value[5]=h*w+j*A+k*E;this.value[9]=h*y+j*B+k*F;this.value[13]=h*x+j*C+k*G+l;this.value[2]=n*v+p*z+o*D;this.value[6]=n*w+p*A+o*E;this.value[10]=n*y+p*B+o*F;this.value[14]=n*x+p*C+o*G+r;this.value[3]=q*v+s*z+t*D;this.value[7]=
q*w+s*A+t*E;this.value[11]=q*y+s*B+t*F;this.value[15]=q*x+s*C+t*G+u;return this};b.prototype.multiplySelf=function(a){this.multiply(m,a);return this};b.prototype.multiplyScalar=function(a){this.value[0]*=a;this.value[4]*=a;this.value[8]*=a;this.value[12]*=a;this.value[1]*=a;this.value[5]*=a;this.value[9]*=a;this.value[13]*=a;this.value[2]*=a;this.value[6]*=a;this.value[10]*=a;this.value[14]*=a;this.value[3]*=a;this.value[7]*=a;this.value[11]*=a;this.value[15]*=a;return this};b.prototype.determinant=
function(){var a=this.value[0],b=this.value[4],g=this.value[8],e=this.value[12],f=this.value[1],i=this.value[5],h=this.value[9],j=this.value[13],k=this.value[2],l=this.value[6],n=this.value[10],p=this.value[14],o=this.value[3],r=this.value[7],q=this.value[11],s=this.value[15];return e*h*l*o-g*j*l*o-e*i*n*o+b*j*n*o+g*i*p*o-b*h*p*o-e*h*k*r+g*j*k*r+e*f*n*r-a*j*n*r-g*f*p*r+a*h*p*r+e*i*k*q-b*j*k*q-e*f*l*q+a*j*l*q+b*f*p*q-a*i*p*q-g*i*k*s+b*h*k*s+g*f*l*s-a*h*l*s-b*f*n*s+a*i*n*s};b.prototype.transpose=function(){var a;
a=this.value[1];this.value[1]=this.value[4];this.value[4]=a;a=this.value[2];this.value[2]=this.value[8];this.value[8]=a;a=this.value[6];this.value[6]=this.value[9];this.value[9]=a;a=this.value[3];this.value[3]=this.value[12];this.value[12]=a;a=this.value[7];this.value[7]=this.value[13];this.value[13]=a;a=this.value[11];this.value[11]=this.value[14];this.value[11]=a;return this};b.prototype.clone=function(){var a=new GLOW.Matrix4;a.value=new Float32Array(this.value);return a};b.prototype.setPosition=
function(a,b,g){this.value[12]=a;this.value[13]=b;this.value[14]=g;return this};b.prototype.addPosition=function(a,b,g){this.value[12]+=a;this.value[13]+=b;this.value[14]+=g};b.prototype.setRotation=function(a,b,g){this.rotation.set(a,b,g);var e=Math.cos(a),a=Math.sin(a),f=Math.cos(b),b=Math.sin(b),i=Math.cos(g),g=Math.sin(g),h=e*b,j=a*b;this.value[0]=f*i;this.value[4]=-f*g;this.value[8]=b;this.value[1]=j*i+e*g;this.value[5]=-j*g+e*i;this.value[9]=-a*f;this.value[2]=-h*i+a*g;this.value[6]=h*g+a*i;
this.value[10]=e*f;return this};b.prototype.addRotation=function(a,b,g){this.rotation.value[0]+=a;this.rotation.value[1]+=b;this.rotation.value[2]+=g;this.setRotation(this.rotation.value[0],this.rotation.value[1],this.rotation.value[2])};b.prototype.getPosition=function(){this.position.set(this.value[12],this.value[13],this.value[14]);return this.position};b.prototype.getColumnX=function(){this.columnX.set(this.value[0],this.value[1],this.value[2]);return this.columnX};b.prototype.getColumnY=function(){this.columnY.set(this.value[4],
this.value[5],this.value[6]);return this.columnY};b.prototype.getColumnZ=function(){this.columnZ.set(this.value[8],this.value[9],this.value[10]);return this.columnZ};b.prototype.scale=function(a,b,g){var e;b!==void 0&&g!==void 0?e=a:(e=a.value[0],b=a.value[1],g=a.value[2]);this.value[0]*=e;this.value[4]*=b;this.value[8]*=g;this.value[1]*=e;this.value[5]*=b;this.value[9]*=g;this.value[2]*=e;this.value[6]*=b;this.value[10]*=g;this.value[3]*=e;this.value[7]*=b;this.value[11]*=g;return this};return b}();
GLOW.Matrix4.makeInverse=function(b,a){a===void 0&&(a=new GLOW.Matrix4);var c=b.value,g=a.value,e=c[0],f=c[4],i=c[8],h=c[12],j=c[1],k=c[5],l=c[9],n=c[13],p=c[2],o=c[6],r=c[10],q=c[14],s=c[3],t=c[7],u=c[11],c=c[15];g[0]=l*q*t-n*r*t+n*o*u-k*q*u-l*o*c+k*r*c;g[1]=n*r*s-l*q*s-n*p*u+j*q*u+l*p*c-j*r*c;g[2]=k*q*s-n*o*s+n*p*t-j*q*t-k*p*c+j*o*c;g[3]=l*o*s-k*r*s-l*p*t+j*r*t+k*p*u-j*o*u;g[4]=h*r*t-i*q*t-h*o*u+f*q*u+i*o*c-f*r*c;g[5]=i*q*s-h*r*s+h*p*u-e*q*u-i*p*c+e*r*c;g[6]=h*o*s-f*q*s-h*p*t+e*q*t+f*p*c-e*o*c;
g[7]=f*r*s-i*o*s+i*p*t-e*r*t-f*p*u+e*o*u;g[8]=i*n*t-h*l*t+h*k*u-f*n*u-i*k*c+f*l*c;g[9]=h*l*s-i*n*s-h*j*u+e*n*u+i*j*c-e*l*c;g[10]=i*n*s-h*k*s+h*j*t-e*n*t-f*j*c+e*k*c;g[11]=i*k*s-f*l*s-i*j*t+e*l*t+f*j*u-e*k*u;g[12]=h*l*o-i*n*o-h*k*r+f*n*r+i*k*q-f*l*q;g[13]=i*n*p-h*l*p+h*j*r-e*n*r-i*j*q+e*l*q;g[14]=h*k*p-f*n*p-h*j*o+e*n*o+f*j*q-e*k*q;g[15]=f*l*p-i*k*p+i*j*o-e*l*o-f*j*r+e*k*r;a.multiplyScalar(1/b.determinant());return a};
GLOW.Matrix4.makeFrustum=function(b,a,c,g,e,f){var i,h;i=new GLOW.Matrix4;h=i.value;h[0]=2*e/(a-b);h[4]=0;h[8]=(a+b)/(a-b);h[12]=0;h[1]=0;h[5]=2*e/(g-c);h[9]=(g+c)/(g-c);h[13]=0;h[2]=0;h[6]=0;h[10]=-(f+e)/(f-e);h[14]=-2*f*e/(f-e);h[3]=0;h[7]=0;h[11]=-1;h[15]=0;return i};GLOW.Matrix4.makeProjection=function(b,a,c,g){var e,b=c*Math.tan(b*Math.PI/360);e=-b;return GLOW.Matrix4.makeFrustum(e*a,b*a,e,b,c,g)};
GLOW.Matrix4.makeOrtho=function(b,a,c,g,e,f){var i,h,j,k,l;i=new GLOW.Matrix4;j=Math.abs(a-b);k=Math.abs(c-g);l=Math.abs(f-e);h=i.value;h[0]=2/j;h[4]=0;h[8]=0;h[12]=-((a+b)/j);h[1]=0;h[5]=2/k;h[9]=0;h[13]=-((c+g)/k);h[2]=0;h[6]=0;h[10]=-2/l;h[14]=-((f+e)/l);h[3]=0;h[7]=0;h[11]=0;h[15]=1;return i};GLOW.Matrix4.tempVector3A=new GLOW.Vector3;GLOW.Matrix4.tempVector3B=new GLOW.Vector3;GLOW.Matrix4.tempVector3C=new GLOW.Vector3;GLOW.Matrix4.tempVector3D=new GLOW.Vector3;
GLOW.Geometry={randomVector3Array:function(b,a){var a=a!==void 0?a:1,c,g=[],e=a*2;for(c=0;c<b;c++)g.push(GLOW.Vector3(Math.random()*e-a,Math.random()*e-a,Math.random()*e-a));return g},randomArray:function(b,a,c,g){var e=[],f=0,i,h;for(h=0;h<b/g;h++){f=a+Math.random()*c;for(i=0;i<g;i++)e.push(f)}return e},triangles:function(b){return this.elements(b)},elements:function(b){var a=0,c,g=new Uint16Array(b*3);for(c=0;c<b;c++)g[a]=a++,g[a]=a++,g[a]=a++;return g},faceNormals:function(b,a){var c=Array(b.length),
g,e=a.length,f,i,h,j=new GLOW.Vector3,k=new GLOW.Vector3,l=new GLOW.Vector3,n=new GLOW.Vector3;for(g=0;g<e;)f=a[g++]*3,i=a[g++]*3,h=a[g++]*3,j.set(b[f+0],b[f+1],b[f+2]),k.set(b[i+0],b[i+1],b[i+2]),l.set(b[h+0],b[h+1],b[h+2]),k.subSelf(j),l.subSelf(j),n.cross(k,l).normalize(),c[f+0]=n.value[0],c[f+1]=n.value[1],c[f+2]=n.value[2],c[i+0]=n.value[0],c[i+1]=n.value[1],c[i+2]=n.value[2],c[h+0]=n.value[0],c[h+1]=n.value[1],c[h+2]=n.value[2];return c},flatShade:function(b,a){if(b.triangles===void 0||b.data===
void 0)console.error("GLOW.Geometry.flatShade: missing .data and/or .triangles in shader config object. Quitting.");else if(a===void 0)console.error("GLOW.Geometry.flatShade: missing attribute data sizes. Quitting.");else{var c=b.triangles,g=c.length/3,e=b.data,f=[],i,h,j,k,l,n,p;for(j in a)if(e[j]){i=e[j];flatShadedAttribute=[];h=a[j];k=0;for(l=g*3;k<l;k++){n=0;for(p=h;n<p;n++)flatShadedAttribute.push(i[c[k]*h+n])}k=i.length=0;for(l=flatShadedAttribute.length;k<l;k++)i[k]=flatShadedAttribute[k]}k=
0;l=g;for(n=0;k<l;k++)f[n]=n++,f[n]=n++,f[n]=n++;b.triangles=f}}};
GLOW.Geometry.Cube={vertices:function(b){var a=new Float32Array(72),c=0,b=b!==void 0?b*0.5:5;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=+b;
a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=+b;a[c++]=-b;a[c++]=-b;a[c++]=+b;return a},indices:function(){var b=new Uint16Array(36),a=0;b[a++]=0;b[a++]=1;b[a++]=2;b[a++]=0;b[a++]=2;b[a++]=3;b[a++]=4;b[a++]=5;b[a++]=6;b[a++]=4;b[a++]=6;b[a++]=7;b[a++]=8;b[a++]=9;b[a++]=
10;b[a++]=8;b[a++]=10;b[a++]=11;b[a++]=12;b[a++]=13;b[a++]=14;b[a++]=12;b[a++]=14;b[a++]=15;b[a++]=16;b[a++]=17;b[a++]=18;b[a++]=16;b[a++]=18;b[a++]=19;b[a++]=20;b[a++]=21;b[a++]=22;b[a++]=20;b[a++]=22;b[a++]=23;return b},primitives:function(){return GL.TRIANGLES},uvs:function(){var b=new Float32Array(48),a=0;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=
0;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=0;b[a++]=0;return b},normals:function(){return GLOW.Geometry.faceNormals(GLOW.Geometry.Cube.vertices(),GLOW.Geometry.Cube.indices())}};
GLOW.Geometry.Plane={vertices:function(b){var a=new Float32Array(12),c=0,b=b!==void 0?b*0.5:1;a[c++]=+b;a[c++]=-b;a[c++]=0;a[c++]=+b;a[c++]=+b;a[c++]=0;a[c++]=-b;a[c++]=+b;a[c++]=0;a[c++]=-b;a[c++]=-b;a[c++]=0;return a},indices:function(){var b=new Uint16Array(6),a=0;b[a++]=0;b[a++]=1;b[a++]=2;b[a++]=0;b[a++]=2;b[a++]=3;return b},uvs:function(){var b=new Float32Array(8),a=0;b[a++]=1;b[a++]=0;b[a++]=1;b[a++]=1;b[a++]=0;b[a++]=1;b[a++]=0;b[a++]=0;return b},primitives:function(){return GL.TRIANGLES}};
GLOW.Node=function(b){this.localMatrix=new GLOW.Matrix4;this.globalMatrix=new GLOW.Matrix4;this.viewMatrix=new GLOW.Matrix4;this.updateRotationMatrix=!1;this.rotationMatrix=new GLOW.Matrix3;this.useXYZStyleTransform=!1;this.position={x:0,y:0,z:0};this.rotation={x:0,y:0,z:0};this.scale={x:1,y:1,z:1};this.children=[];this.parent=void 0;if(b)this.shader=b,this.draw=b.draw};
GLOW.Node.prototype.update=function(b,a){this.useXYZStyleTransform&&(this.localMatrix.setPosition(this.position.x,this.position.y,this.position.z),this.localMatrix.setRotation(this.rotation.x,this.rotation.y,this.rotation.z),this.localMatrix.scale(this.scale.x,this.scale.y,this.scale.z));b?this.globalMatrix.multiply(b,this.localMatrix):this.globalMatrix.copy(this.localMatrix);this.updateRotationMatrix&&this.rotationMatrix.extractFromMatrix4(this.globalMatrix);a&&this.viewMatrix.multiply(a,this.globalMatrix);
var c,g=this.children.length;for(c=0;c<g;c++)this.children[c].update(this.globalMatrix,a);return this};GLOW.Node.prototype.addChild=function(b){if(this.children.indexOf(b)===-1)this.children.push(b),b.parent&&b.parent.removeChild(b),b.parent=this;return this};GLOW.Node.prototype.removeChild=function(b){var a=this.children.indexOf(b);if(a!==-1)this.children.splice(1,a),b.parent=void 0;return this};
GLOW.Camera=function(b){GLOW.Node.call(this);b=b!==void 0?b:{};this.fov=b.fov!==void 0?b.fov:40;this.aspect=b.aspect!==void 0?b.aspect:window.innerWidth/window.innerHeight;this.near=b.near!==void 0?b.near:0.1;this.far=b.far!==void 0?b.far:1E4;this.useTarget=b.useTarget!==void 0?b.useTarget:!0;this.projection=b.ortho!==void 0?GLOW.Matrix4.makeOrtho(b.ortho.left,b.ortho.right,b.ortho.top,b.ortho.bottom,this.near,this.far):GLOW.Matrix4.makeProjection(this.fov,this.aspect,this.near,this.far);this.inverse=
new GLOW.Matrix4;this.target=new GLOW.Vector3(0,0,-100);this.up=new GLOW.Vector3(0,1,0);this.update()};GLOW.Camera.prototype=new GLOW.Node;GLOW.Camera.prototype.constructor=GLOW.Camera;GLOW.Camera.prototype.supr=GLOW.Node.prototype;
GLOW.Camera.prototype.update=function(b,a){this.useXYZStyleTransform?(this.localMatrix.setPosition(this.position.x,this.position.y,this.position.z),this.useTarget?this.localMatrix.lookAt(this.target,this.up):this.localMatrix.setRotation(this.rotation.x,this.rotation.y,this.rotation.z),this.localMatrix.scale(this.scale.x,this.scale.y,this.scale.z)):this.useTarget&&this.localMatrix.lookAt(this.target,this.up);b?this.globalMatrix.multiply(b,this.localMatrix):this.globalMatrix.copy(this.localMatrix);
GLOW.Matrix4.makeInverse(this.globalMatrix,this.inverse);var c,g=this.children.length;for(c=0;c<g;c++)this.children[c].update(this.globalMatrix,a)};GLOW.defaultCamera=new GLOW.Camera;
GLOW.Load=function(){var b=function(a){this.parameters=a;this.numItemsLeftToLoad=this.numItemsToLoad=0;for(var b in a)b!=="onLoadComplete"&&b!=="onLoadItem"&&b!=="dontParseJS"&&(this.numItemsToLoad++,this.numItemsLeftToLoad++);for(b in a)if(b==="onLoadComplete")this.onLoadComplete=a[b];else if(b==="onLoadItem")this.onLoadItem=a[b];else if(b==="dontParseJS")this.dontParseJS=a[b];else{var g=a[b],e=a[b];e.indexOf(".png")!==-1||e.indexOf(".gif")!==-1||e.indexOf(".jpg")!==-1||e.indexOf("jpeg")!==-1?(a[b]=
new Image,a[b].scope=this,a[b].onload=this.onLoadImage,a[b].src=g):e.indexOf(".glsl")!==-1?(a[b]=new XMLHttpRequest,a[b].scope=this,a[b].parametersProperty=b,a[b].open("GET",g),a[b].onreadystatechange=this.onLoadGLSL,a[b].send()):e.indexOf(".js")!==-1||e.indexOf(".json")!==-1?(a[b]=new XMLHttpRequest,a[b].scope=this,a[b].parametersProperty=b,a[b].open("GET",g),a[b].onreadystatechange=this.onLoadJSON,a[b].send()):(a[b]=document.createElement("video"),a[b].scope=this,a[b].addEventListener("loadeddata",
this.onLoadVideo,!1),a[b].src=g)}};b.prototype.handleLoadedItem=function(){this.numItemsLeftToLoad--;this.onLoadItem!==void 0&&this.onLoadItem.call(null,1-this.numItemsLeftToLoad/this.numItemsToLoad);this.numItemsLeftToLoad<=0&&this.onLoadComplete.call(null,this.parameters)};b.prototype.onLoadJSON=function(){this.readyState===4&&(this.scope.parameters[this.parametersProperty]=JSON.parse(this.responseText),this.scope.handleLoadedItem())};b.prototype.onLoadImage=function(){this.scope.handleLoadedItem()};
b.prototype.onLoadVideo=function(){this.removeEventListener("loadeddata",this.scope.onLoadVideo,!1);this.scope.handleLoadedItem()};b.prototype.onLoadGLSL=function(){if(this.readyState===4){for(var a="",b="",b=this.responseText.split("\n"),g="",e=0;e<b.length;e++)if(b[e].indexOf("//#")>-1)b[e].indexOf("Fragment")>-1&&(a=g,g="");else{var f=b[e];f.indexOf("//")>-1&&(f=f.substring(0,f.indexOf("//")));g+=f}this.scope.parameters[this.parametersProperty]={fragmentShader:"#ifdef GL_ES\nprecision highp float;\n#endif\n"+
g,vertexShader:a};this.scope.handleLoadedItem()}};b.prototype.parseThreeJS=function(a){var b={},g=a.scale!==void 0?1/a.scale:1;(function(e){if(a.version===void 0||a.version!=2)console.error("Deprecated file format.");else{var f,g,h,j,k,l,n,p,o,r,q,s,t,u,v=a.faces;l=a.vertices;var w=a.normals,y=a.colors,x=0;for(f=0;f<a.uvs.length;f++)a.uvs[f].length&&x++;for(f=0;f<x;f++)b.faceUvs[f]=[],b.faceVertexUvs[f]=[];j=0;for(k=l.length;j<k;)n=new THREE.Vertex,n.position.x=l[j++]*e,n.position.y=l[j++]*e,n.position.z=
l[j++]*e,b.vertices.push(n);j=0;for(k=v.length;j<k;){e=v[j++];l=e&1;h=e&2;f=e&4;g=e&8;p=e&16;n=e&32;r=e&64;e&=128;l?(q=new THREE.Face4,q.a=v[j++],q.b=v[j++],q.c=v[j++],q.d=v[j++],l=4):(q=new THREE.Face3,q.a=v[j++],q.b=v[j++],q.c=v[j++],l=3);if(h)h=v[j++],q.materials=b.materials[h];h=b.faces.length;if(f)for(f=0;f<x;f++)s=a.uvs[f],o=v[j++],u=s[o*2],o=s[o*2+1],b.faceUvs[f][h]=new THREE.UV(u,o);if(g)for(f=0;f<x;f++){s=a.uvs[f];t=[];for(g=0;g<l;g++)o=v[j++],u=s[o*2],o=s[o*2+1],t[g]=new THREE.UV(u,o);b.faceVertexUvs[f][h]=
t}if(p)p=v[j++]*3,g=new THREE.Vector3,g.x=w[p++],g.y=w[p++],g.z=w[p],q.normal=g;if(n)for(f=0;f<l;f++)p=v[j++]*3,g=new THREE.Vector3,g.x=w[p++],g.y=w[p++],g.z=w[p],q.vertexNormals.push(g);if(r)n=v[j++],n=new THREE.Color(y[n]),q.color=n;if(e)for(f=0;f<l;f++)n=v[j++],n=new THREE.Color(y[n]),q.vertexColors.push(n);b.faces.push(q)}}})(g);(function(){var e,f,g,h;if(a.skinWeights){e=0;for(f=a.skinWeights.length;e<f;e+=2)g=a.skinWeights[e],h=a.skinWeights[e+1],b.skinWeights.push(new THREE.Vector4(g,h,0,0))}if(a.skinIndices){e=
0;for(f=a.skinIndices.length;e<f;e+=2)g=a.skinIndices[e],h=a.skinIndices[e+1],b.skinIndices.push(new THREE.Vector4(g,h,0,0))}b.bones=a.bones;b.animation=a.animation})();(function(e){if(a.morphTargets!==void 0){var f,g,h,j,k,l,n,p,o;f=0;for(g=a.morphTargets.length;f<g;f++){b.morphTargets[f]={};b.morphTargets[f].name=a.morphTargets[f].name;b.morphTargets[f].vertices=[];p=b.morphTargets[f].vertices;o=a.morphTargets[f].vertices;h=0;for(j=o.length;h<j;h+=3)k=o[h]*e,l=o[h+1]*e,n=o[h+2]*e,p.push(new THREE.Vertex(new THREE.Vector3(k,
l,n)))}}if(a.morphColors!==void 0){f=0;for(g=a.morphColors.length;f<g;f++){b.morphColors[f]={};b.morphColors[f].name=a.morphColors[f].name;b.morphColors[f].colors=[];j=b.morphColors[f].colors;k=a.morphColors[f].colors;e=0;for(h=k.length;e<h;e+=3)l=new THREE.Color(16755200),l.setRGB(k[e],k[e+1],k[e+2]),j.push(l)}}})(g);(function(){if(a.edges!==void 0){var e,f,g;for(e=0;e<a.edges.length;e+=2)f=a.edges[e],g=a.edges[e+1],b.edges.push(new THREE.Edge(b.vertices[f],b.vertices[g],f,g))}})()};return b}();
GLOW.ShaderUtils={createMultiple:function(b,a){if(b.triangles===void 0||b.data===void 0)console.error("GLOW.ShaderUtils.createMultiple: missing .data and/or .triangles in shader config object. Quitting.");else{var c,g=b.triangles,e=b.data,f,i=[],h,j,k,l,n,p,o=0,r=g.length;do{i.push(f={elements:[]});c=f.elements;for(k in a)if(e[k])f[k]=[];else{console.error("GLOW.ShaderUtils.createMultiple: attribute "+d+" doesn't exist in originalShaderConfig.data. Quitting.");return}for(j=0;o<r;o+=3){if(j>65533){o-=
3;break}c[j]=j++;c[j]=j++;c[j]=j++;for(k in a){h=e[k];size=a[k];for(p=0;p<3;p++){l=0;for(n=size;l<n;l++)f[k].push(h[g[o+p]*size+l])}}}}while(o<r);for(k in a)b.data[k]=i[0][k];b.triangles=i[0].elements;c=new GLOW.Shader(b);g=[c];for(o=1;o<i.length;o++){for(k in a)b.data[k]=i[o][k];e=GLOW.Compiler.createAttributes(GLOW.Compiler.extractAttributes(c.compiledData.program),b.data,b.usage,b.interleave);e=GLOW.Compiler.interleaveAttributes(e,b.interleave);for(l in e)i[o][l]=e[l];g[o]=c.clone(i[o])}return g}}};
